/**
 * @file Firebase Security Rules for Sina Estate Manager.
 *
 * Core Philosophy:
 * This ruleset starts with allowing authenticated users to perform most actions
 * during the development and prototyping phase. It provides a secure base by
 * default-denying all access and then selectively opening it up.
 * As the application matures, these rules should be refined to be more specific,
 * for example, by adding ownership checks.
 */
rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {

    // Helper function to check if a user is signed in.
    function isSignedIn() {
      return request.auth != null;
    }

    /**
     * @description Default-deny all reads and writes.
     */
    match /{document=**} {
      allow read, write: if false;
    }

    /**
     * @description Allow authenticated users to read and write to the 'villas' collection.
     */
    match /villas/{villaId} {
      allow read, write: if isSignedIn();
    }

    /**
     * @description Allow authenticated users to read and write to the 'personnel' collection.
     */
    match /personnel/{personnelId} {
      allow read, write: if isSignedIn();
    }

     /**
     * @description Allow authenticated users to read and write to the 'stakeholders' collection.
     */
    match /stakeholders/{stakeholderId} {
      allow read, write: if isSignedIn();
    }

    /**
     * @description Allow authenticated users to read and write to the 'financial_transactions' collection.
     */
    match /financial_transactions/{transactionId} {
      allow read, write: if isSignedIn();
    }
    
    /**
     * @description Allow authenticated users to read and write to the 'documents' collection.
     */
    match /documents/{documentId} {
        allow read, write: if isSignedIn();
    }

    /**
     * @description Allow authenticated users to read and write to the 'estates' collection.
     */
    match /estates/{estateId} {
        allow read, write: if isSignedIn();
    }

    /**
     * @description Allow authenticated users to read and write to the 'payrolls' collection.
     */
    match /payrolls/{payrollId} {
        allow read, write: if isSignedIn();
    }
    
    /**
     * @description Allow authenticated users to read and write to the 'attendances' collection.
     */
    match /attendances/{attendanceId} {
        allow read, write: if isSignedIn();
    }

    /**
     * @description Allow authenticated users to read and write to the 'payroll_settings' collection.
     */
    match /payroll_settings/{settingId} {
        allow read, write: if isSignedIn();
    }
  }
}
